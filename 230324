-- 별칭 또는 오라클 객체명의 경우, 쌍따옴표(DOUBLE QUOTATION)을 사용하지 않는 경우
-- 기본값(DEFAULT VALUE)가 대문자로 저장/출력
-- UNPIVOT 방법 4 : 인라인뷰 소문자
SELECT *
FROM (SELECT deptno
           , max(decode(job, 'CLERK', sal)) AS "clerk"
           , max(decode(job, 'SALESMAN', sal)) AS "sales"
           , max(decode(job, 'PRESIDENT', sal)) AS "president"
           , max(decode(job, 'MANAGER', sal)) AS "manager"
           , max(decode(job, 'ANALYST', sal)) AS "analyst"
GROUP BY DEPTNO 
ORDER BY DEPTNO 
UNPIVOT(SAL FOR JOB IN (clerk, sales, presi, man, ana))  -- 모두 대문자로 변경
ORDER BY DEPTNO, JOB;
 
/*
 * INNER_JOIN 1:1 관계로 테이블간 연결을 통해 추가 정보를 제공하는 목적이 대부분
 */
SELECT *
FROM EMP E JOIN DEPT D 
ON E.DEPTNO = D.DEPTNO;

SELECT E.EMPNO
      ,E.ENAME
      ,E.JOB
      ,E.HIREDATE
      ,E.SAL
      ,E.COMM
      ,D.DEPTNO
      ,D.DNAME
      ,D.LOC
FROM EMP E JOIN DEPT D    -- INNER JOIN 교집합
  ON E.DEPTNO = D.DEPTNO  -- 직원과 부서가 1:1 관계
;

/*
 * SAL 구간을 이용하여 해당 구간에 해당되는 직원을 연결(1:1 관계)
 */
SELECT E.EMPNO
      ,E.ENAME
      ,S.GRADE
      ,E.JOB
      ,E.HIREDATE
      ,E.SAL
      ,E.COMM
      ,E.DEPTNO
      ,S.LOSAL
      ,S.HISAL
FROM EMP E, SALGRADE S  
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL 
;

CREATE TABLE EMP_NEW 
;
(
   empno     NUMBER(4)         -- 4자리 정수 표혐
   ,ename    VARCHAR2(10)      -- 가변 문자열 10자리
   ,job      varchar2(9)
   ,mgr      number(4)         -- empno와 동일한 사번
   ,hiredate DATE              -- 계산이 가능한 날짜
   ,SAL      number(7,2)       -- 소수점 2자리 정밀도 처리
   ,comm     number(7,2)
   ,deptno   number(2)
);

ALTER TABLE EMP_NEW 
ADD tel varchar(20)
;

COMMIT ;

ALTER TABLE EMP_NEW 
MODIFY empno number(5)        -- 기존 4자리 정수에서 다행히 5자리로 확대

COMMIT ;

/*
 * SEQUENCE (시퀀스) 생성
 * 
 * 필요한 일련번호를 만들어 사용하거나, 일련번호를 PK로 만들어 생성하는 경우에 사용
 */

SELECT *
FROM DEPT_TEMP2 dt
;
